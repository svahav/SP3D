public with sharing class GardenReservationMailer {
    @AuraEnabled
    public static void sendReservationEmail(String email, String fullName, Datetime reservationDateTime, Integer guestCount, Id reservationId) {
        String formattedDate = reservationDateTime.format('dd/MM/yyyy');
        String formattedTime = reservationDateTime.format('HH:mm');

        String logoUrl = 'https://abra6-dev-ed.develop.my.salesforce.com/sfc/dist/version/download/?oid=00DWU00000Ed9Zi&ids=068WU000009bbZh&d=%2Fa%2FWU0000004vHR%2FkDnYLp8wqbGqkhQZau0H8vxJpjkxoovA9z_ITqIlzoo&asPdf=false';

        // ğŸ”³ ×™×¦×™×¨×ª ×§×™×©×•×¨ QR ×œ×”×–×× ×”

        String qrUrl = 'https://api.qrserver.com/v1/create-qr-code/?size=250x250&data=https://midnightbrew.coffee/reservation?Id=' + reservationId;

        String body =
            '<html><body dir="rtl" style="font-family: Arial, sans-serif; background-color: #f9f6f1; color: #3b3b3b; padding: 20px;">' +
            '<div style="max-width: 600px; margin: auto; background-color: white; padding: 30px; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.05);">' +
            '<div style="text-align: center;">' +
            '<img src="' + logoUrl + '" alt="MidnightBrew" style="max-height: 60px; margin-bottom: 24px;" />' +
            '<h2 style="color: #5e473a;">×”×”×–×× ×” ×œ×’×™× ×” ×”×ª×§×‘×œ×”!</h2>' +
            '<p style="font-size: 16px;">×©×œ×•× ' + fullName + ',</p>' +
            '<p>×©××—×™× ×©×‘×—×¨×ª ×œ×©×‘×ª ××™×ª× ×• ×‘×’×™× ×ª ×”×§×¤×” ×©×œ× ×•. ×”× ×” ×”×¤×¨×˜×™×:</p>' +
            '</div>' +

            '<hr style="margin: 30px 0;" />' +

            '<div style="font-size: 15px; line-height: 1.6;">' +
            '<p><strong>×ª××¨×™×š ×”×”×–×× ×”:</strong> ' + formattedDate + '</p>' +
            '<p><strong>×©×¢×”:</strong> ' + formattedTime + '</p>' +
            '<p><strong>××¡×¤×¨ ××©×ª×ª×¤×™×:</strong> ' + guestCount + '</p>' +
            '</div>' +

            '<div style="text-align: center; margin-top: 30px;">' +
            '<p>×”×¦×’ ××ª ×”-QR ×”×‘× ×›×©××ª×” ××’×™×¢:</p>' +
            '<img src="' + qrUrl + '" alt="QR ×œ×”×–×× ×”" style="width: 250px; height: 250px;" />' +
            '</div>' +

            '<p style="margin-top: 40px;">× ×©××— ×œ××¨×— ××•×ª×š ×‘×©×§×˜ ×©×‘×’×™× ×” ×©×œ× ×• ğŸŒ¿</p>' +
            '<p style="font-weight: bold;">×¦×•×•×ª MidnightBrew â˜•</p>' +

            '<div style="margin-top: 40px; text-align: center; font-size: 12px; color: #999;">' +
            '<p>×”××™×™×œ × ×©×œ×— ××•×˜×•××˜×™×ª. ××™×Ÿ ×œ×”×©×™×‘ ××œ×™×•.</p>' +
            '</div>' +
            '</div></body></html>';

        Messaging.SingleEmailMessage mail = new Messaging.SingleEmailMessage();
        mail.setToAddresses(new String[] { email });
        mail.setSubject('××™×©×•×¨ ×”×–×× ×” ×œ×’×™× ×” - MidnightBrew');
        mail.setHtmlBody(body);

        List<OrgWideEmailAddress> oweaList = [
            SELECT Id FROM OrgWideEmailAddress WHERE Address = 'vahav.shira1997@gmail.com' LIMIT 1
        ];
        if (!oweaList.isEmpty()) {
            mail.setOrgWideEmailAddressId(oweaList[0].Id);
        }

        Messaging.sendEmail(new Messaging.SingleEmailMessage[] { mail });
    }
}